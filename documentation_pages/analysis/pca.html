<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.9.2. Principal Component Analysis (PCA) — MDAnalysis.analysis.pca &mdash; MDAnalysis 0.15.1-dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.15.1-dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.15.1-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.15.1-dev0 documentation" href="../../index.html" />
    <link rel="up" title="3. Analysis modules" href="../analysis_modules.html" />
    <link rel="next" title="4. Topology modules" href="../topology_modules.html" />
    <link rel="prev" title="3.9.1. Diffusion map — MDAnalysis.analysis.diffusionmap" href="diffusionmap.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../topology_modules.html" title="4. Topology modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="diffusionmap.html" title="3.9.1. Diffusion map — MDAnalysis.analysis.diffusionmap"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.15.1-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" accesskey="U">3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.9.2. Principal Component Analysis (PCA) &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.pca</span></code></a><ul>
<li><a class="reference internal" href="#functions">3.9.2.1. Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="diffusionmap.html"
                        title="previous chapter">3.9.1. Diffusion map &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.diffusionmap</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../topology_modules.html"
                        title="next chapter">4. Topology modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/analysis/pca.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.pca"></span><div class="section" id="principal-component-analysis-pca-mdanalysis-analysis-pca">
<h1>3.9.2. Principal Component Analysis (PCA) &#8212; <a class="reference internal" href="#module-MDAnalysis.analysis.pca" title="MDAnalysis.analysis.pca"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.pca</span></code></a><a class="headerlink" href="#principal-component-analysis-pca-mdanalysis-analysis-pca" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">John Detlefs</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2016</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
</tbody>
</table>
<p>This module contains the linear dimensions reduction method Principal Component
Analysis (PCA). PCA sorts a simulation into 3N directions of descending
variance, with N being the number of atoms. These directions are called
the principal components. The dimensions to be analyzed are reduced by only
looking at a few projections of the first principal components. To learn how to
run a Principal Component Analysis, please refer to the <span class="xref std std-ref">PCA-tutorial</span>.</p>
<p>The PCA problem is solved by solving the eigenvalue problem of the covariance
matrix, a 3N x 3N matrix where the element (i, j) is the covariance between
coordinates i and j. The principal components are the eigenvectors of this
matrix.</p>
<p>For each eigenvector, its eigenvalue is the variance that the eigenvector
explains. Stored in <a href="#id1"><span class="problematic" id="id2">:attribute:`cumulated_variance`</span></a>, a ratio for each number of
eigenvectors up to index i is provided to quickly find out how many principal
components are needed to explain the amount of variance reflected by those i
eigenvectors. For most data, <a href="#id3"><span class="problematic" id="id4">:attribute:`cumulated_variance`</span></a> will be
approximately equal to one for some n that is significantly smaller than the
total number of components, these are the components of interest given
by Principal Component Analysis.</p>
<p>From here, we can project a trajectory onto these principal components and
attempt to retrieve some structure from our high dimensional data.</p>
<p>For a basic introduction to the module, the <span class="xref std std-ref">PCA-tutorial</span> shows how
to perform Principal Component Analysis.</p>
<p>The example uses files provided as part of the MDAnalysis test suite
(in the variables <code class="xref py py-data docutils literal"><span class="pre">PSF</span></code> and
<code class="xref py py-data docutils literal"><span class="pre">DCD</span></code>). This tutorial shows how to use the
PCA class.</p>
<dl class="docutils">
<dt>First load all modules and test data</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis.analysis.pca</span> <span class="kn">as</span> <span class="nn">pca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
</pre></div>
</div>
</dd>
</dl>
<p>Given a universe containing trajectory data we can perform Principal Component
Analyis by using the class <a class="reference internal" href="#MDAnalysis.analysis.pca.PCA" title="MDAnalysis.analysis.pca.PCA"><code class="xref py py-class docutils literal"><span class="pre">PCA</span></code></a> and retrieving the principal
components.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF_pca</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Inspect the components to determine the principal components you would like
to retain. The choice is arbitrary, but I will stop when 95 percent of the
variance is explained by the components. This cumulated variance by the
components is conveniently stored in the one-dimensional array attribute
<cite>cumulated_variance</cite>. The value at the ith index of <cite>cumulated_variance</cite> is the
sum of the variances from 0 to i.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_pcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">PSF_pca</span><span class="o">.</span><span class="n">cumulated_var</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomgroup</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_space</span> <span class="o">=</span> <span class="n">PSF_pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">atomgroup</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="n">n_pcs</span><span class="p">)</span>
</pre></div>
</div>
<p>From here, inspection of the pca_space and conclusions to be drawn from the
data are left to the user.</p>
<div class="section" id="functions">
<h2>3.9.2.1. Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.pca.PCA">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.pca.</code><code class="descname">PCA</code><span class="sig-paren">(</span><em>atomgroup</em>, <em>select='all'</em>, <em>align=False</em>, <em>mean=None</em>, <em>n_components=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/pca.html#PCA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA" title="Permalink to this definition">¶</a></dt>
<dd><p>Principal component analysis on an MD trajectory.</p>
<p>After initializing and calling method with a universe or an atom group,
principal components ordering the atom coordinate data by decreasing
variance will be available for analysis. As an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">atomgroup</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_space</span> <span class="o">=</span>  <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">atomgroup</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>generates the principal components of the backbone of the atomgroup and
then transforms those atomgroup coordinates by the direction of those
variances. Please refer to the <span class="xref std std-ref">PCA-tutorial</span> for more detailed
instructions.</p>
<dl class="attribute">
<dt id="MDAnalysis.analysis.pca.PCA.p_components">
<code class="descname">p_components</code><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.p_components" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array, (n_components, n_atoms * 3)</em></p>
<p>The principal components of the feature space,
representing the directions of maximum variance in the data.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.pca.PCA.variance">
<code class="descname">variance</code><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.variance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array (n_components, )</em></p>
<p>The raw variance explained by each eigenvector of the covariance
matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.pca.PCA.cumulated_variance">
<code class="descname">cumulated_variance</code><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.cumulated_variance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array, (n_components, )</em></p>
<p>Percentage of variance explained by the selected components and the sum
of the components preceding it. If a subset of components is not chosen
then all components are stored and the cumulated variance will converge
to 1.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.pca.PCA.pca_space">
<code class="descname">pca_space</code><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.pca_space" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array (n_frames, n_components)</em></p>
<p>After running <a href="#id5"><span class="problematic" id="id6">:method:`pca.transform(atomgroup)`</span></a> the projection of the
positions onto the principal components will exist here.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.pca.PCA.mean_atoms">
<code class="descname">mean_atoms</code><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.mean_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>MDAnalyis atomgroup</em></p>
<p>After running <a href="#id7"><span class="problematic" id="id8">:method:`PCA.run()`</span></a>, the mean position of all the atoms
used for the creation of the covariance matrix will exist here.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.pca.PCA.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>atomgroup</em>, <em>n_components=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/pca.html#PCA.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.pca.PCA.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an atomgroup or universe with the same number of atoms as was
used for the calculation in <a href="#id9"><span class="problematic" id="id10">:method:`PCA.run()`</span></a> and project it onto the
principal components.</p>
</dd></dl>

<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atomgroup</strong> (<em>MDAnalysis atomgroup</em>) &#8211; AtomGroup to be used for PCA.</li>
<li><strong>select</strong> (<em>string, optional</em>) &#8211; A valid selection statement for choosing a subset of atoms from
the atomgroup.</li>
<li><strong>align</strong> (<em>boolean, optional</em>) &#8211; If True, the trajectory will be aligned to a reference
structure.</li>
<li><strong>mean</strong> (<em>MDAnalysis atomgroup, optional</em>) &#8211; An optional reference structure to be used as the mean of the
covariance matrix.</li>
<li><strong>n_components</strong> (<em>int, optional</em>) &#8211; The number of principal components to be saved, default saves
all principal components, Default: None</li>
<li><strong>start</strong> (<em>int, optional</em>) &#8211; First frame of trajectory to use for generation
of covariance matrix, Default: None</li>
<li><strong>stop</strong> (<em>int, optional</em>) &#8211; Last frame of trajectory to use for generation
of covariance matrix, Default: None</li>
<li><strong>step</strong> (<em>int, optional</em>) &#8211; Step between frames of trajectory to use for generation
of covariance matrix, Default: None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.pca.cosine_content">
<code class="descclassname">MDAnalysis.analysis.pca.</code><code class="descname">cosine_content</code><span class="sig-paren">(</span><em>pca_space</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/pca.html#cosine_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.pca.cosine_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the cosine content of the PCA projection.</p>
<p>The cosine content of pca projections can be used as an indicator if a
simulation is converged. Values close to 1 are an indicator that the
simulation isn&#8217;t converged. For values below 0.7 no statement can be made.
If you use this function please cite <a class="reference internal" href="#berkhess1" id="id11">[BerkHess1]</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pca_space</strong> (<em>array, shape (number of frames, number of components)</em>) &#8211; The PCA space to be analyzed.</li>
<li><strong>i</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The index of the pca_component projectection to be analyzed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>A float reflecting the cosine content of the ith projection in the PCA</em></li>
<li><em>space. The output is bounded by 0 and 1, with 1 reflecting an agreement</em></li>
<li><em>with cosine while 0 reflects complete disagreement.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="berkhess1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[BerkHess1]</a></td><td></td></tr>
</tbody>
</table>
<p>Berk Hess. Convergence of sampling in protein simulations. Phys. Rev. E
65, 031910 (2002).</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../topology_modules.html" title="4. Topology modules"
             >next</a> |</li>
        <li class="right" >
          <a href="diffusionmap.html" title="3.9.1. Diffusion map — MDAnalysis.analysis.diffusionmap"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.15.1-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" >3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Balasubramanian, Jonathan Barnoud, Alejandro Bernardin, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Lukas Stelzl, Gorman Stock, Isaac Virshup, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>